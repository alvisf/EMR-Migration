21/06/12 08:22:52 INFO RMProxy: Connecting to ResourceManager at ip-172-31-23-162.ap-south-1.compute.internal/172.31.23.162:8032
21/06/12 08:22:52 INFO Client: Requesting a new application from cluster with 2 NodeManagers
21/06/12 08:22:52 INFO Configuration: resource-types.xml not found
21/06/12 08:22:52 INFO ResourceUtils: Unable to find 'resource-types.xml'.
21/06/12 08:22:52 INFO ResourceUtils: Adding resource type - name = memory-mb, units = Mi, type = COUNTABLE
21/06/12 08:22:52 INFO ResourceUtils: Adding resource type - name = vcores, units = , type = COUNTABLE
21/06/12 08:22:52 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (12288 MB per container)
21/06/12 08:22:52 INFO Client: Will allocate AM container, with 2432 MB memory including 384 MB overhead
21/06/12 08:22:52 INFO Client: Setting up container launch context for our AM
21/06/12 08:22:52 INFO Client: Setting up the launch environment for our AM container
21/06/12 08:22:52 INFO Client: Preparing resources for our AM container
21/06/12 08:22:52 WARN Client: Neither spark.yarn.jars nor spark.yarn.archive is set, falling back to uploading libraries under SPARK_HOME.
21/06/12 08:22:55 INFO Client: Uploading resource file:/mnt/tmp/spark-1da0b07f-4e7a-4a35-8ad0-23c6ef99b0bb/__spark_libs__5767212078381041004.zip -> hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001/__spark_libs__5767212078381041004.zip
21/06/12 08:22:57 INFO ClientConfigurationFactory: Set initial getObject socket timeout to 2000 ms.
21/06/12 08:22:57 INFO Client: Uploading resource s3://my-website-alvisf/vendor_migration.py -> hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001/vendor_migration.py
21/06/12 08:22:59 INFO S3NativeFileSystem: Opening 's3://my-website-alvisf/vendor_migration.py' for reading
21/06/12 08:22:59 INFO Client: Uploading resource file:/usr/lib/spark/python/lib/pyspark.zip -> hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001/pyspark.zip
21/06/12 08:22:59 INFO Client: Uploading resource file:/usr/lib/spark/python/lib/py4j-0.10.7-src.zip -> hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001/py4j-0.10.7-src.zip
21/06/12 08:23:00 INFO Client: Uploading resource file:/mnt/tmp/spark-1da0b07f-4e7a-4a35-8ad0-23c6ef99b0bb/__spark_conf__4001618497852229521.zip -> hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001/__spark_conf__.zip
21/06/12 08:23:00 INFO SecurityManager: Changing view acls to: hadoop
21/06/12 08:23:00 INFO SecurityManager: Changing modify acls to: hadoop
21/06/12 08:23:00 INFO SecurityManager: Changing view acls groups to: 
21/06/12 08:23:00 INFO SecurityManager: Changing modify acls groups to: 
21/06/12 08:23:00 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(hadoop); groups with view permissions: Set(); users  with modify permissions: Set(hadoop); groups with modify permissions: Set()
21/06/12 08:23:01 INFO Client: Submitting application application_1623485207640_0001 to ResourceManager
21/06/12 08:23:01 INFO YarnClientImpl: Submitted application application_1623485207640_0001
21/06/12 08:23:02 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:02 INFO Client: 
	 client token: N/A
	 diagnostics: AM container is launched, waiting for AM container to Register with RM
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1623486181563
	 final status: UNDEFINED
	 tracking URL: http://ip-172-31-23-162.ap-south-1.compute.internal:20888/proxy/application_1623485207640_0001/
	 user: hadoop
21/06/12 08:23:03 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:04 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:05 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:06 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:07 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:08 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:09 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:10 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:11 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:12 INFO Client: Application report for application_1623485207640_0001 (state: ACCEPTED)
21/06/12 08:23:13 INFO Client: Application report for application_1623485207640_0001 (state: FAILED)
21/06/12 08:23:13 INFO Client: 
	 client token: N/A
	 diagnostics: Application application_1623485207640_0001 failed 2 times due to AM Container for appattempt_1623485207640_0001_000002 exited with  exitCode: 13
Failing this attempt.Diagnostics: [2021-06-12 08:23:13.219]Exception from container-launch.
Container id: container_1623485207640_0001_02_000001
Exit code: 13

[2021-06-12 08:23:13.225]Container exited with a non-zero exit code 13. Error file: prelaunch.err.
Last 4096 bytes of prelaunch.err :
Last 4096 bytes of stderr :
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/mnt/yarn/usercache/hadoop/filecache/11/__spark_libs__5767212078381041004.zip/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for TERM
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for HUP
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for INT
21/06/12 08:23:09 INFO SecurityManager: Changing view acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing view acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yarn, hadoop); groups with view permissions: Set(); users  with modify permissions: Set(yarn, hadoop); groups with modify permissions: Set()
21/06/12 08:23:10 INFO ApplicationMaster: Preparing Local resources
21/06/12 08:23:10 INFO ApplicationMaster: ApplicationAttemptId: appattempt_1623485207640_0001_000002
21/06/12 08:23:10 INFO ApplicationMaster: Starting the user application in a separate Thread
21/06/12 08:23:10 INFO ApplicationMaster: Waiting for spark context initialization...
21/06/12 08:23:12 ERROR ApplicationMaster: User application exited with status 2
21/06/12 08:23:12 INFO ApplicationMaster: Final app status: FAILED, exitCode: 13, (reason: User application exited with status 2)
21/06/12 08:23:12 ERROR ApplicationMaster: Uncaught exception: 
org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:226)
	at org.apache.spark.deploy.yarn.ApplicationMaster.runDriver(ApplicationMaster.scala:472)
	at org.apache.spark.deploy.yarn.ApplicationMaster.org$apache$spark$deploy$yarn$ApplicationMaster$$runImpl(ApplicationMaster.scala:308)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply$mcV$sp(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$3.run(ApplicationMaster.scala:783)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1926)
	at org.apache.spark.deploy.yarn.ApplicationMaster.doAsUser(ApplicationMaster.scala:782)
	at org.apache.spark.deploy.yarn.ApplicationMaster.run(ApplicationMaster.scala:247)
	at org.apache.spark.deploy.yarn.ApplicationMaster$.main(ApplicationMaster.scala:807)
	at org.apache.spark.deploy.yarn.ApplicationMaster.main(ApplicationMaster.scala)
Caused by: org.apache.spark.SparkUserAppException: User application exited with 2
	at org.apache.spark.deploy.PythonRunner$.main(PythonRunner.scala:114)
	at org.apache.spark.deploy.PythonRunner.main(PythonRunner.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:688)
21/06/12 08:23:12 INFO ApplicationMaster: Deleting staging directory hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001
21/06/12 08:23:12 INFO ShutdownHookManager: Shutdown hook called


[2021-06-12 08:23:13.225]Container exited with a non-zero exit code 13. Error file: prelaunch.err.
Last 4096 bytes of prelaunch.err :
Last 4096 bytes of stderr :
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/mnt/yarn/usercache/hadoop/filecache/11/__spark_libs__5767212078381041004.zip/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for TERM
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for HUP
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for INT
21/06/12 08:23:09 INFO SecurityManager: Changing view acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing view acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yarn, hadoop); groups with view permissions: Set(); users  with modify permissions: Set(yarn, hadoop); groups with modify permissions: Set()
21/06/12 08:23:10 INFO ApplicationMaster: Preparing Local resources
21/06/12 08:23:10 INFO ApplicationMaster: ApplicationAttemptId: appattempt_1623485207640_0001_000002
21/06/12 08:23:10 INFO ApplicationMaster: Starting the user application in a separate Thread
21/06/12 08:23:10 INFO ApplicationMaster: Waiting for spark context initialization...
21/06/12 08:23:12 ERROR ApplicationMaster: User application exited with status 2
21/06/12 08:23:12 INFO ApplicationMaster: Final app status: FAILED, exitCode: 13, (reason: User application exited with status 2)
21/06/12 08:23:12 ERROR ApplicationMaster: Uncaught exception: 
org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:226)
	at org.apache.spark.deploy.yarn.ApplicationMaster.runDriver(ApplicationMaster.scala:472)
	at org.apache.spark.deploy.yarn.ApplicationMaster.org$apache$spark$deploy$yarn$ApplicationMaster$$runImpl(ApplicationMaster.scala:308)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply$mcV$sp(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$3.run(ApplicationMaster.scala:783)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1926)
	at org.apache.spark.deploy.yarn.ApplicationMaster.doAsUser(ApplicationMaster.scala:782)
	at org.apache.spark.deploy.yarn.ApplicationMaster.run(ApplicationMaster.scala:247)
	at org.apache.spark.deploy.yarn.ApplicationMaster$.main(ApplicationMaster.scala:807)
	at org.apache.spark.deploy.yarn.ApplicationMaster.main(ApplicationMaster.scala)
Caused by: org.apache.spark.SparkUserAppException: User application exited with 2
	at org.apache.spark.deploy.PythonRunner$.main(PythonRunner.scala:114)
	at org.apache.spark.deploy.PythonRunner.main(PythonRunner.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:688)
21/06/12 08:23:12 INFO ApplicationMaster: Deleting staging directory hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001
21/06/12 08:23:12 INFO ShutdownHookManager: Shutdown hook called


For more detailed output, check the application tracking page: http://ip-172-31-23-162.ap-south-1.compute.internal:8088/cluster/app/application_1623485207640_0001 Then click on links to logs of each attempt.
. Failing the application.
	 ApplicationMaster host: N/A
	 ApplicationMaster RPC port: -1
	 queue: default
	 start time: 1623486181563
	 final status: FAILED
	 tracking URL: http://ip-172-31-23-162.ap-south-1.compute.internal:8088/cluster/app/application_1623485207640_0001
	 user: hadoop
21/06/12 08:23:13 ERROR Client: Application diagnostics message: Application application_1623485207640_0001 failed 2 times due to AM Container for appattempt_1623485207640_0001_000002 exited with  exitCode: 13
Failing this attempt.Diagnostics: [2021-06-12 08:23:13.219]Exception from container-launch.
Container id: container_1623485207640_0001_02_000001
Exit code: 13

[2021-06-12 08:23:13.225]Container exited with a non-zero exit code 13. Error file: prelaunch.err.
Last 4096 bytes of prelaunch.err :
Last 4096 bytes of stderr :
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/mnt/yarn/usercache/hadoop/filecache/11/__spark_libs__5767212078381041004.zip/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for TERM
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for HUP
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for INT
21/06/12 08:23:09 INFO SecurityManager: Changing view acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing view acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yarn, hadoop); groups with view permissions: Set(); users  with modify permissions: Set(yarn, hadoop); groups with modify permissions: Set()
21/06/12 08:23:10 INFO ApplicationMaster: Preparing Local resources
21/06/12 08:23:10 INFO ApplicationMaster: ApplicationAttemptId: appattempt_1623485207640_0001_000002
21/06/12 08:23:10 INFO ApplicationMaster: Starting the user application in a separate Thread
21/06/12 08:23:10 INFO ApplicationMaster: Waiting for spark context initialization...
21/06/12 08:23:12 ERROR ApplicationMaster: User application exited with status 2
21/06/12 08:23:12 INFO ApplicationMaster: Final app status: FAILED, exitCode: 13, (reason: User application exited with status 2)
21/06/12 08:23:12 ERROR ApplicationMaster: Uncaught exception: 
org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:226)
	at org.apache.spark.deploy.yarn.ApplicationMaster.runDriver(ApplicationMaster.scala:472)
	at org.apache.spark.deploy.yarn.ApplicationMaster.org$apache$spark$deploy$yarn$ApplicationMaster$$runImpl(ApplicationMaster.scala:308)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply$mcV$sp(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$3.run(ApplicationMaster.scala:783)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1926)
	at org.apache.spark.deploy.yarn.ApplicationMaster.doAsUser(ApplicationMaster.scala:782)
	at org.apache.spark.deploy.yarn.ApplicationMaster.run(ApplicationMaster.scala:247)
	at org.apache.spark.deploy.yarn.ApplicationMaster$.main(ApplicationMaster.scala:807)
	at org.apache.spark.deploy.yarn.ApplicationMaster.main(ApplicationMaster.scala)
Caused by: org.apache.spark.SparkUserAppException: User application exited with 2
	at org.apache.spark.deploy.PythonRunner$.main(PythonRunner.scala:114)
	at org.apache.spark.deploy.PythonRunner.main(PythonRunner.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:688)
21/06/12 08:23:12 INFO ApplicationMaster: Deleting staging directory hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001
21/06/12 08:23:12 INFO ShutdownHookManager: Shutdown hook called


[2021-06-12 08:23:13.225]Container exited with a non-zero exit code 13. Error file: prelaunch.err.
Last 4096 bytes of prelaunch.err :
Last 4096 bytes of stderr :
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/mnt/yarn/usercache/hadoop/filecache/11/__spark_libs__5767212078381041004.zip/slf4j-log4j12-1.7.16.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for TERM
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for HUP
21/06/12 08:23:09 INFO SignalUtils: Registered signal handler for INT
21/06/12 08:23:09 INFO SecurityManager: Changing view acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls to: yarn,hadoop
21/06/12 08:23:09 INFO SecurityManager: Changing view acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: Changing modify acls groups to: 
21/06/12 08:23:09 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(yarn, hadoop); groups with view permissions: Set(); users  with modify permissions: Set(yarn, hadoop); groups with modify permissions: Set()
21/06/12 08:23:10 INFO ApplicationMaster: Preparing Local resources
21/06/12 08:23:10 INFO ApplicationMaster: ApplicationAttemptId: appattempt_1623485207640_0001_000002
21/06/12 08:23:10 INFO ApplicationMaster: Starting the user application in a separate Thread
21/06/12 08:23:10 INFO ApplicationMaster: Waiting for spark context initialization...
21/06/12 08:23:12 ERROR ApplicationMaster: User application exited with status 2
21/06/12 08:23:12 INFO ApplicationMaster: Final app status: FAILED, exitCode: 13, (reason: User application exited with status 2)
21/06/12 08:23:12 ERROR ApplicationMaster: Uncaught exception: 
org.apache.spark.SparkException: Exception thrown in awaitResult: 
	at org.apache.spark.util.ThreadUtils$.awaitResult(ThreadUtils.scala:226)
	at org.apache.spark.deploy.yarn.ApplicationMaster.runDriver(ApplicationMaster.scala:472)
	at org.apache.spark.deploy.yarn.ApplicationMaster.org$apache$spark$deploy$yarn$ApplicationMaster$$runImpl(ApplicationMaster.scala:308)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply$mcV$sp(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anonfun$run$1.apply(ApplicationMaster.scala:248)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$3.run(ApplicationMaster.scala:783)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1926)
	at org.apache.spark.deploy.yarn.ApplicationMaster.doAsUser(ApplicationMaster.scala:782)
	at org.apache.spark.deploy.yarn.ApplicationMaster.run(ApplicationMaster.scala:247)
	at org.apache.spark.deploy.yarn.ApplicationMaster$.main(ApplicationMaster.scala:807)
	at org.apache.spark.deploy.yarn.ApplicationMaster.main(ApplicationMaster.scala)
Caused by: org.apache.spark.SparkUserAppException: User application exited with 2
	at org.apache.spark.deploy.PythonRunner$.main(PythonRunner.scala:114)
	at org.apache.spark.deploy.PythonRunner.main(PythonRunner.scala)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.spark.deploy.yarn.ApplicationMaster$$anon$2.run(ApplicationMaster.scala:688)
21/06/12 08:23:12 INFO ApplicationMaster: Deleting staging directory hdfs://ip-172-31-23-162.ap-south-1.compute.internal:8020/user/hadoop/.sparkStaging/application_1623485207640_0001
21/06/12 08:23:12 INFO ShutdownHookManager: Shutdown hook called


For more detailed output, check the application tracking page: http://ip-172-31-23-162.ap-south-1.compute.internal:8088/cluster/app/application_1623485207640_0001 Then click on links to logs of each attempt.
. Failing the application.
Exception in thread "main" org.apache.spark.SparkException: Application application_1623485207640_0001 finished with failed status
	at org.apache.spark.deploy.yarn.Client.run(Client.scala:1163)
	at org.apache.spark.deploy.yarn.YarnClusterApplication.start(Client.scala:1543)
	at org.apache.spark.deploy.SparkSubmit.org$apache$spark$deploy$SparkSubmit$$runMain(SparkSubmit.scala:853)
	at org.apache.spark.deploy.SparkSubmit.doRunMain$1(SparkSubmit.scala:161)
	at org.apache.spark.deploy.SparkSubmit.submit(SparkSubmit.scala:184)
	at org.apache.spark.deploy.SparkSubmit.doSubmit(SparkSubmit.scala:86)
	at org.apache.spark.deploy.SparkSubmit$$anon$2.doSubmit(SparkSubmit.scala:928)
	at org.apache.spark.deploy.SparkSubmit$.main(SparkSubmit.scala:937)
	at org.apache.spark.deploy.SparkSubmit.main(SparkSubmit.scala)
21/06/12 08:23:13 INFO ShutdownHookManager: Shutdown hook called
21/06/12 08:23:13 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-a9a02945-b6e1-4ae8-be2f-c5b741ea0825
21/06/12 08:23:13 INFO ShutdownHookManager: Deleting directory /mnt/tmp/spark-1da0b07f-4e7a-4a35-8ad0-23c6ef99b0bb
Command exiting with ret '1'